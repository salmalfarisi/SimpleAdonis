"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const Validator_1 = global[Symbol.for('ioc.use')]("Adonis/Core/Validator");
const User_1 = __importDefault(global[Symbol.for('ioc.use')]("App/Models/User"));
const Hash_1 = __importDefault(global[Symbol.for('ioc.use')]("Adonis/Core/Hash"));
const Database_1 = __importDefault(global[Symbol.for('ioc.use')]("Adonis/Lucid/Database"));
class AccountsController {
    async Login({ session, view, response }) {
        if (session.get('id') != null) {
            response.redirect().toRoute('ArticlesController.Index');
        }
        else {
            return view.render("content.user.login");
        }
    }
    async PostLogin({ auth, session, request, response }) {
        const checkexist = await auth.use('web').attempt(request.input('email'), request.input('password'));
        const user = await User_1.default
            .query()
            .where('email', request.input('email'))
            .firstOrFail();
        if (await Hash_1.default.verify(user.password, request.input('password'))) {
            const result = await auth.use('web').login(user);
            session.put('id', user.id);
            session.put('name', user.name);
            session.put('email', user.email);
            session.flash('success', 'Successfully Login');
            response.redirect().toRoute('ArticlesController.Index');
        }
        else {
            session.flash('danger', 'Username or password not found in database');
            response.redirect().back();
        }
    }
    async Registration({ session, view, response }) {
        if (session.get('id') != null) {
            response.redirect().toRoute('ArticlesController.Index');
        }
        else {
            return view.render("content.user.register");
        }
    }
    async PostRegistration({ session, request, response }) {
        const newUserSchema = Validator_1.schema.create({
            name: Validator_1.schema.string([
                Validator_1.rules.required(),
            ]),
            email: Validator_1.schema.string([
                Validator_1.rules.required(),
                Validator_1.rules.email(),
                Validator_1.rules.unique({ table: 'users', column: 'email' }),
            ]),
            password: Validator_1.schema.string([
                Validator_1.rules.required(),
            ]),
            password_confirmation: Validator_1.schema.string([
                Validator_1.rules.required(),
                Validator_1.rules.confirmed('password'),
            ])
        });
        const trx = await Database_1.default.transaction();
        try {
            const payload = await request.validate({
                schema: newUserSchema
            });
            var settime = new Date();
            var now = settime.getFullYear() + '-' + settime.getMonth() + '-' + settime.getDate() + " " + settime.getHours() + ":" + settime.getMinutes() + ":" + settime.getSeconds();
            const password = await Hash_1.default.make(request.input('password'));
            const newdata = {
                email: request.input('email'),
                name: request.input('name'),
                password: password,
                created_at: now,
            };
            await trx
                .insertQuery()
                .table('users')
                .insert(newdata);
            await trx.commit();
            session.flash('success', 'User successfully created');
            response.redirect().back();
        }
        catch (error) {
            await trx.rollback();
            let errors = error.messages;
            console.log(error);
            for (const key in errors) {
                session.flash(key, errors[key]);
            }
            response.redirect().back();
        }
    }
    async Logout({ session, auth, response }) {
        await auth.use('web').logout();
        session.clear();
        response.redirect('/');
    }
}
exports.default = AccountsController;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQWNjb3VudHNDb250cm9sbGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQWNjb3VudHNDb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQzs7Ozs7QUFFYiwyRUFBMkQ7QUFDM0QsaUZBQW1DO0FBQ25DLGtGQUF5QztBQUN6QywyRkFBaUQ7QUFFakQsTUFBcUIsa0JBQWtCO0lBQ3RDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRTtRQUV0QyxJQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxFQUM1QjtZQUNDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxPQUFPLENBQUMsMEJBQTBCLENBQUMsQ0FBQztTQUN4RDthQUVEO1lBQ0MsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLG9CQUFvQixDQUFDLENBQUM7U0FDekM7SUFDRixDQUFDO0lBRUQsS0FBSyxDQUFDLFNBQVMsQ0FBQyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRTtRQUVuRCxNQUFNLFVBQVUsR0FBRyxNQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO1FBRXBHLE1BQU0sSUFBSSxHQUFHLE1BQU0sY0FBSTthQUNyQixLQUFLLEVBQUU7YUFDUCxLQUFLLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7YUFDdEMsV0FBVyxFQUFFLENBQUE7UUFHZixJQUFJLE1BQU0sY0FBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLENBQUMsRUFDL0Q7WUFDQyxNQUFNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2pELE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUMzQixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDL0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRWpDLE9BQU8sQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFLG9CQUFvQixDQUFDLENBQUM7WUFDL0MsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1NBQ3hEO2FBRUQ7WUFDQyxPQUFPLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSw0Q0FBNEMsQ0FBQyxDQUFDO1lBQ3RFLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUMzQjtJQUNGLENBQUM7SUFFRCxLQUFLLENBQUMsWUFBWSxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUU7UUFFN0MsSUFBRyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksRUFDNUI7WUFDQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUMsT0FBTyxDQUFDLDBCQUEwQixDQUFDLENBQUM7U0FDeEQ7YUFFRDtZQUNDLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1NBQzVDO0lBQ0YsQ0FBQztJQUVELEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFO1FBS3BELE1BQU0sYUFBYSxHQUFHLGtCQUFNLENBQUMsTUFBTSxDQUFDO1lBQ25DLElBQUksRUFBRSxrQkFBTSxDQUFDLE1BQU0sQ0FBQztnQkFDbkIsaUJBQUssQ0FBQyxRQUFRLEVBQUU7YUFDaEIsQ0FBQztZQUNGLEtBQUssRUFBRSxrQkFBTSxDQUFDLE1BQU0sQ0FBQztnQkFDcEIsaUJBQUssQ0FBQyxRQUFRLEVBQUU7Z0JBQ2hCLGlCQUFLLENBQUMsS0FBSyxFQUFFO2dCQUNiLGlCQUFLLENBQUMsTUFBTSxDQUFDLEVBQUMsS0FBSyxFQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUMsT0FBTyxFQUFDLENBQUM7YUFDN0MsQ0FBQztZQUNGLFFBQVEsRUFBRSxrQkFBTSxDQUFDLE1BQU0sQ0FBQztnQkFDdEIsaUJBQUssQ0FBQyxRQUFRLEVBQUU7YUFDakIsQ0FBQztZQUNGLHFCQUFxQixFQUFFLGtCQUFNLENBQUMsTUFBTSxDQUFDO2dCQUNuQyxpQkFBSyxDQUFDLFFBQVEsRUFBRTtnQkFDaEIsaUJBQUssQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDO2FBQzVCLENBQUM7U0FDQSxDQUFDLENBQUE7UUFFSixNQUFNLEdBQUcsR0FBRyxNQUFNLGtCQUFRLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDekMsSUFBSTtZQUtILE1BQU0sT0FBTyxHQUFHLE1BQU0sT0FBTyxDQUFDLFFBQVEsQ0FBQztnQkFDckMsTUFBTSxFQUFFLGFBQWE7YUFDdEIsQ0FBQyxDQUFDO1lBRUgsSUFBSSxPQUFPLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztZQUN6QixJQUFJLEdBQUcsR0FBRyxPQUFPLENBQUMsV0FBVyxFQUFFLEdBQUcsR0FBRyxHQUFHLE9BQU8sQ0FBQyxRQUFRLEVBQUUsR0FBRyxHQUFHLEdBQUcsT0FBTyxDQUFDLE9BQU8sRUFBRSxHQUFHLEdBQUcsR0FBRyxPQUFPLENBQUMsUUFBUSxFQUFFLEdBQUcsR0FBRyxHQUFHLE9BQU8sQ0FBQyxVQUFVLEVBQUUsR0FBRyxHQUFHLEdBQUcsT0FBTyxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzFLLE1BQU0sUUFBUSxHQUFHLE1BQU0sY0FBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7WUFDNUQsTUFBTSxPQUFPLEdBQUc7Z0JBQ2YsS0FBSyxFQUFHLE9BQU8sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO2dCQUM5QixJQUFJLEVBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7Z0JBQzVCLFFBQVEsRUFBRyxRQUFRO2dCQUNuQixVQUFVLEVBQUcsR0FBRzthQUNoQixDQUFBO1lBRUQsTUFBTSxHQUFHO2lCQUNOLFdBQVcsRUFBRTtpQkFDYixLQUFLLENBQUMsT0FBTyxDQUFDO2lCQUNkLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUVuQixNQUFNLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUVuQixPQUFPLENBQUMsS0FBSyxDQUFDLFNBQVMsRUFBRSwyQkFBMkIsQ0FBQyxDQUFDO1lBQ3RELFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUMzQjtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBSWYsTUFBTSxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDckIsSUFBSSxNQUFNLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQztZQUM1QixPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ25CLEtBQUssTUFBTSxHQUFHLElBQUksTUFBTSxFQUFFO2dCQUN6QixPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQzthQUNoQztZQUNELFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUMzQjtJQUNGLENBQUM7SUFFRCxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUU7UUFFdkMsTUFBTSxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQy9CLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNoQixRQUFRLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hCLENBQUM7Q0FDRDtBQTVIRCxxQ0E0SEMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbmltcG9ydCB0eXBlIHsgSHR0cENvbnRleHRDb250cmFjdCB9IGZyb20gJ0Bpb2M6QWRvbmlzL0NvcmUvSHR0cENvbnRleHQnO1xuaW1wb3J0IHsgc2NoZW1hLCBydWxlcyB9IGZyb20gJ0Bpb2M6QWRvbmlzL0NvcmUvVmFsaWRhdG9yJztcbmltcG9ydCBVc2VyIGZyb20gJ0FwcC9Nb2RlbHMvVXNlcic7XG5pbXBvcnQgSGFzaCBmcm9tICdAaW9jOkFkb25pcy9Db3JlL0hhc2gnO1xuaW1wb3J0IERhdGFiYXNlIGZyb20gJ0Bpb2M6QWRvbmlzL0x1Y2lkL0RhdGFiYXNlJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBY2NvdW50c0NvbnRyb2xsZXIge1xuXHRhc3luYyBMb2dpbih7IHNlc3Npb24sIHZpZXcsIHJlc3BvbnNlIH0pXG5cdHtcblx0XHRpZihzZXNzaW9uLmdldCgnaWQnKSAhPSBudWxsKVxuXHRcdHtcblx0XHRcdHJlc3BvbnNlLnJlZGlyZWN0KCkudG9Sb3V0ZSgnQXJ0aWNsZXNDb250cm9sbGVyLkluZGV4Jyk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHRyZXR1cm4gdmlldy5yZW5kZXIoXCJjb250ZW50LnVzZXIubG9naW5cIik7XG5cdFx0fVxuXHR9XG5cdFxuXHRhc3luYyBQb3N0TG9naW4oeyBhdXRoLCBzZXNzaW9uLCByZXF1ZXN0LCByZXNwb25zZSB9KVxuXHR7XG5cdFx0Y29uc3QgY2hlY2tleGlzdCA9IGF3YWl0IGF1dGgudXNlKCd3ZWInKS5hdHRlbXB0KHJlcXVlc3QuaW5wdXQoJ2VtYWlsJyksIHJlcXVlc3QuaW5wdXQoJ3Bhc3N3b3JkJykpO1xuXG5cdFx0Y29uc3QgdXNlciA9IGF3YWl0IFVzZXJcblx0XHRcdC5xdWVyeSgpXG5cdFx0XHQud2hlcmUoJ2VtYWlsJywgcmVxdWVzdC5pbnB1dCgnZW1haWwnKSlcblx0XHRcdC5maXJzdE9yRmFpbCgpXG5cblx0XHQvLyBWZXJpZnkgcGFzc3dvcmRcblx0XHRpZiAoYXdhaXQgSGFzaC52ZXJpZnkodXNlci5wYXNzd29yZCwgcmVxdWVzdC5pbnB1dCgncGFzc3dvcmQnKSkpXG5cdFx0e1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgYXV0aC51c2UoJ3dlYicpLmxvZ2luKHVzZXIpO1xuXHRcdFx0c2Vzc2lvbi5wdXQoJ2lkJywgdXNlci5pZCk7XG5cdFx0XHRzZXNzaW9uLnB1dCgnbmFtZScsIHVzZXIubmFtZSk7XG5cdFx0XHRzZXNzaW9uLnB1dCgnZW1haWwnLCB1c2VyLmVtYWlsKTtcblx0XHRcblx0XHRcdHNlc3Npb24uZmxhc2goJ3N1Y2Nlc3MnLCAnU3VjY2Vzc2Z1bGx5IExvZ2luJyk7XG5cdFx0XHRyZXNwb25zZS5yZWRpcmVjdCgpLnRvUm91dGUoJ0FydGljbGVzQ29udHJvbGxlci5JbmRleCcpO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0c2Vzc2lvbi5mbGFzaCgnZGFuZ2VyJywgJ1VzZXJuYW1lIG9yIHBhc3N3b3JkIG5vdCBmb3VuZCBpbiBkYXRhYmFzZScpO1xuXHRcdFx0cmVzcG9uc2UucmVkaXJlY3QoKS5iYWNrKCk7XG5cdFx0fVxuXHR9XG5cdFxuXHRhc3luYyBSZWdpc3RyYXRpb24oeyBzZXNzaW9uLCB2aWV3LCByZXNwb25zZSB9KVxuXHR7XG5cdFx0aWYoc2Vzc2lvbi5nZXQoJ2lkJykgIT0gbnVsbClcblx0XHR7XG5cdFx0XHRyZXNwb25zZS5yZWRpcmVjdCgpLnRvUm91dGUoJ0FydGljbGVzQ29udHJvbGxlci5JbmRleCcpO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0cmV0dXJuIHZpZXcucmVuZGVyKFwiY29udGVudC51c2VyLnJlZ2lzdGVyXCIpO1xuXHRcdH1cblx0fVxuXHRcblx0YXN5bmMgUG9zdFJlZ2lzdHJhdGlvbih7IHNlc3Npb24sIHJlcXVlc3QsIHJlc3BvbnNlIH0pXG5cdHtcblx0XHQvKipcblx0XHQgICAqIFN0ZXAgMSAtIERlZmluZSBzY2hlbWFcblx0XHQqLyAgIFxuXHRcdGNvbnN0IG5ld1VzZXJTY2hlbWEgPSBzY2hlbWEuY3JlYXRlKHtcblx0XHRcdG5hbWU6IHNjaGVtYS5zdHJpbmcoW1xuXHRcdFx0XHRydWxlcy5yZXF1aXJlZCgpLFxuXHRcdFx0XSksXG5cdFx0XHRlbWFpbDogc2NoZW1hLnN0cmluZyhbXG5cdFx0XHRcdHJ1bGVzLnJlcXVpcmVkKCksXG5cdFx0XHRcdHJ1bGVzLmVtYWlsKCksXG5cdFx0XHRcdHJ1bGVzLnVuaXF1ZSh7dGFibGU6J3VzZXJzJywgY29sdW1uOidlbWFpbCd9KSxcblx0XHRcdF0pLFxuXHRcdFx0cGFzc3dvcmQ6IHNjaGVtYS5zdHJpbmcoW1xuXHRcdFx0ICBydWxlcy5yZXF1aXJlZCgpLFxuXHRcdFx0XSksXG5cdFx0XHRwYXNzd29yZF9jb25maXJtYXRpb246IHNjaGVtYS5zdHJpbmcoW1xuXHRcdFx0ICBydWxlcy5yZXF1aXJlZCgpLFxuXHRcdFx0ICBydWxlcy5jb25maXJtZWQoJ3Bhc3N3b3JkJyksXG5cdFx0XHRdKVxuXHRcdCAgfSlcblxuXHRcdGNvbnN0IHRyeCA9IGF3YWl0IERhdGFiYXNlLnRyYW5zYWN0aW9uKCk7XG5cdFx0dHJ5IHtcblx0XHRcdC8qKlxuXHRcdFx0ICogU3RlcCAyIC0gVmFsaWRhdGUgcmVxdWVzdCBib2R5IGFnYWluc3Rcblx0XHRcdCAqICAgICAgICAgIHRoZSBzY2hlbWFcblx0XHRcdCAqL1xuXHRcdFx0Y29uc3QgcGF5bG9hZCA9IGF3YWl0IHJlcXVlc3QudmFsaWRhdGUoe1xuXHRcdFx0ICBzY2hlbWE6IG5ld1VzZXJTY2hlbWFcblx0XHRcdH0pO1xuXHRcdFx0XG5cdFx0XHR2YXIgc2V0dGltZSA9IG5ldyBEYXRlKCk7XG5cdFx0XHR2YXIgbm93ID0gc2V0dGltZS5nZXRGdWxsWWVhcigpICsgJy0nICsgc2V0dGltZS5nZXRNb250aCgpICsgJy0nICsgc2V0dGltZS5nZXREYXRlKCkgKyBcIiBcIiArIHNldHRpbWUuZ2V0SG91cnMoKSArIFwiOlwiICsgc2V0dGltZS5nZXRNaW51dGVzKCkgKyBcIjpcIiArIHNldHRpbWUuZ2V0U2Vjb25kcygpO1xuXHRcdFx0Y29uc3QgcGFzc3dvcmQgPSBhd2FpdCBIYXNoLm1ha2UocmVxdWVzdC5pbnB1dCgncGFzc3dvcmQnKSk7XG5cdFx0XHRjb25zdCBuZXdkYXRhID0ge1xuXHRcdFx0XHRlbWFpbCA6IHJlcXVlc3QuaW5wdXQoJ2VtYWlsJyksXG5cdFx0XHRcdG5hbWUgOiByZXF1ZXN0LmlucHV0KCduYW1lJyksXG5cdFx0XHRcdHBhc3N3b3JkIDogcGFzc3dvcmQsXG5cdFx0XHRcdGNyZWF0ZWRfYXQgOiBub3csXG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGF3YWl0IHRyeFxuXHRcdFx0ICAuaW5zZXJ0UXVlcnkoKVxuXHRcdFx0ICAudGFibGUoJ3VzZXJzJylcblx0XHRcdCAgLmluc2VydChuZXdkYXRhKTtcblx0XHRcdFxuXHRcdFx0YXdhaXQgdHJ4LmNvbW1pdCgpO1xuXHRcdFx0XG5cdFx0XHRzZXNzaW9uLmZsYXNoKCdzdWNjZXNzJywgJ1VzZXIgc3VjY2Vzc2Z1bGx5IGNyZWF0ZWQnKTtcblx0XHRcdHJlc3BvbnNlLnJlZGlyZWN0KCkuYmFjaygpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIFN0ZXAgMyAtIEhhbmRsZSBlcnJvcnNcblx0XHRcdCAqL1xuXHRcdFx0YXdhaXQgdHJ4LnJvbGxiYWNrKCk7XG5cdFx0XHRsZXQgZXJyb3JzID0gZXJyb3IubWVzc2FnZXM7XG5cdFx0XHRjb25zb2xlLmxvZyhlcnJvcik7XG5cdFx0XHRmb3IgKGNvbnN0IGtleSBpbiBlcnJvcnMpIHtcblx0XHRcdFx0c2Vzc2lvbi5mbGFzaChrZXksIGVycm9yc1trZXldKTtcblx0XHRcdH1cblx0XHRcdHJlc3BvbnNlLnJlZGlyZWN0KCkuYmFjaygpO1xuXHRcdH1cblx0fVxuXHRcblx0YXN5bmMgTG9nb3V0KHsgc2Vzc2lvbiwgYXV0aCwgcmVzcG9uc2UgfSlcblx0e1xuXHRcdGF3YWl0IGF1dGgudXNlKCd3ZWInKS5sb2dvdXQoKTtcblx0XHRzZXNzaW9uLmNsZWFyKCk7XG5cdFx0cmVzcG9uc2UucmVkaXJlY3QoJy8nKTtcblx0fVxufVxuIl19